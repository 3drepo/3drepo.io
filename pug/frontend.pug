doctype html
html(lang="en")
	head
		base(href="/")

		// Meta, title, CSS, favicons, etc.
		meta(charset='utf-8')
		meta(http-equiv='X-UA-Compatible', content='IE=edge')
		meta(name="viewport" content="width=device-width, initial-scale=1")
		
		// Theme colour (PWA)
		meta(name="theme-color" content="#0c2f54")

		title 3D Repo | Online BIM collaboration platform

		// Manifest file (PWA)
		link(rel="manifest" href="/manifest.json")

	body

		// Frontend plugin Pug files
		each j in frontendPug
			script(type="text/ng-template", id=j.id)
				!= renderMe(j.path, locals)

		// Legal pages
		each j in legalTemplates
			script(type="text/ng-template", id=j.page+".html")
				!= renderMe(j.path, locals)

		// Inline CSS if CSS fails, also faster
		style.
			body #notSupported {
				max-width: 100%;
				max-height: 100%;
				overflow: hidden;
				position: absolute;
				background: #0c2f54;
				color: white;
				left: 0;
				right: 0;
				width: 100%;
				height: 100%;
				text-align: center;
				z-index: 10;
				font-size: 20px;
			}

			body #notSupported a {
				color: #289874;
			}

			body #notSupported img {
				margin: 4%;
				width: 90%;
				max-width: 500px;
			}

			body #notSupported div {
				margin: 4%; 
				text-align: center;
			}

		noscript
			#notSupported(aria-label="Not Supported")
				div
					img(src="public/images/3drepo-logo-white.png")
				div
					| JavaScript is currently disabled, this site requires JavaScript to run!


		#notSupported(style='visibility:hidden', aria-label="Not Supported")
			div
					img(src="public/images/3drepo-logo-white.png")
			div
				| Your browser is not supported.
				| Please upgrade to the latest version of 
				a(href='https://www.google.co.uk/chrome', target='_blank') Chrome
				| , 
				a(href='https://www.mozilla.org/firefox', target='_blank') FireFox
				|  or 
				a(target='_blank', href='https://www.microsoft.com/en-gb/windows/microsoft-edge') Edge
				br
				br
				br
				input(
					id='notSupportedButton' 
					type='button'
					value='OK'
					style='padding:10px 60px; font-size:14px;' 
					onclick='document.getElementById("notSupported").style.visibility="hidden"')

		// Fallback for IE 

		|<!--[if (IE)]>
		|	<script type="text/javascript">
		|		document.getElementById('notSupported').style.visibility='visible';
		|		document.getElementById('notSupportedButton').style.display = 'none';
		|	</script>
		|	
		|<![endif]-->

		// Entry point for all components
		home(flex, layout="column")

		// CSS AND JAVASCRIPT -----------------------------------------------------------------------------------------

		// All CSS minified
		link(rel='stylesheet', type='text/css', href='/public/dist/three_d_repo.min.css')

		// Styling used in the Angular Material demos
		link(rel="stylesheet", href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,400italic")
	
		// Load config from server and dependencies + 3D Repo JavaScript
		script(type="text/javascript", src="/config.js")
		script(type="text/javascript", src='/public/dist/three_d_repo.min.js', async)

		// ReCapthca
		script(src="//www.google.com/recaptcha/api.js?render=explicit&onload=vcRecaptchaApiLoaded", async)

		// Google Code for Remarketing Tag
		//
			------------------------------------------------
			Remarketing tags may not be associated with personally identifiable information or placed on pages related to sensitive categories. 
			See more information and instructions on how to setup the tag on: http://google.com/ads/remarketingsetup
			-------------------------------------------------
			
		if googleConversionId

			script(type='text/javascript').
				/* <![CDATA[ */
				var google_conversion_id = !{googleConversionId};
				var google_custom_params = window.google_tag_params;
				var google_remarketing_only = true;
				/* ]]> */
			script(type='text/javascript', src='//www.googleadservices.com/pagead/conversion.js', async)

			noscript
				div(style='display:inline;')
					img(height='1'
						width='1'
						style='border-style:none;'
						alt=''
						src='//googleads.g.doubleclick.net/pagead/viewthroughconversion/#{googleConversionId}/?guid=ON&script=0')

		if development
			// Else load LiveReload
			script(src="//localhost:35729/livereload.js", async)


